<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of smooth_derivative</title>
  <meta name="keywords" content="smooth_derivative">
  <meta name="description" content="[y_derivative,y_smoothed] = smooth_derivative(y,n_window,method,x)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">nca</a> &gt; <a href="index.html">nca_auxiliary</a> &gt; smooth_derivative.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for nca/nca_auxiliary&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>smooth_derivative
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>[y_derivative,y_smoothed] = smooth_derivative(y,n_window,method,x)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [y_derivative,y_smoothed] = smooth_derivative(y,n_window,method,x) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> [y_derivative,y_smoothed] = smooth_derivative(y,n_window,method,x)

 Smoothen time series and compute a robust time derivative
 The function is computed by regression (linear, square, or cubic) 
 within a sliding window of size 1+2*n_window around the respective data point.

 y            row vector of function values. if y is a matrix, each row is treated separately.
 n_window     half width (# data points) of sliding window (default 5)
 method       'linear','square', 'cubic'
 x            (optional) row vector of time points corresponding to function values in y
              the values must be increasing
              the default for x is equally spaced values 1..n 

 y_derivative estimated time derivative
 y_smoothed   smoothed version of y

Test case 1:
 x = [0:0.1:10];
 y_true = sin(x) ;
 y = y_true + 0.1*randn(size(y_true));
 y_der_naive = [y(:,2)-y(:,1), 0.5*[y(:,3:end)-y(:,1:end-2)], y(:,end)-y(:,end-1)]/(x(1,2)-x(1,1));
 [y_derivative,y_smoothed] = smooth_derivative(y,20,'cubic',x);
 plot(x(:),y_true(:),'.'); hold on; 
 plot(x(:),y(:),'c.');
 plot(x(:),y_smoothed(:),'b');
 plot(x(:),y_der_naive(:),'r.');
 plot(x(:),y_derivative(:),'r'); hold off

Test case 2:
 y = [zeros(1,100) 1:100] + 0.5*randn(1,200);
 [y_der,y_smooth] = smooth_derivative(y,10,'linear');
 y_der_naive = [y(:,2)-y(:,1), 0.5*[y(:,3:end)-y(:,1:end-2)], y(:,end)-y(:,end-1)];
 figure(1); plot(y); hold on;  
 plot(y_smooth,'r'); hold off; legend('Data','Smoothed');
 figure(2); plot(y_der_naive(:),'.'); hold on
 plot(y_der,'r');  hold off; legend('Differences','Smooth derivative');</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../nca/nca_expression/gfp_data/preprocess_gfp_data.html" class="code" title="function [DD,info] = preprocess_gfp_data(D, s1, v1, s2, v2, s3, v3,s4, v4, s5, v5, s6, v6, s7, v7, s8, v8,s9, v9, s10, v10, s11, v11, s12, v12,s13, v13, s14, v14, s15, v15)">preprocess_gfp_data</a>	function [DD,info] = preprocess_gfp_data(D,parameters)</li></ul>
<!-- crossreference -->




<hr><address>Generated on Fri 15-Jan-2021 15:22:45 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>